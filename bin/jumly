#!/usr/bin/env bash
script_path=$1
format=$2
encoding=$3

if [ -z "$script_path" ]; then
  cat<<EOF
usage: `basename $0` <script-path> [format] [encoding]
  script-path    ./examples/You-get-JUMLY.jm
  format         png | jpg
  encoding       image | base64 | html

ex)
  `basename $0` examples/You-get-JUMLY.jm png
  `basename $0` examples/You-get-JUMLY.jm png base64

EOF
  exit
fi

here=`pwd`
cwd=$(dirname `\ls -l $0 | awk '{if ($11) {print $11} else {print $9}}'`)/..
cd $cwd

npm_bin=$cwd/node_modules/.bin
$npm_bin/phantomjs \
  $cwd/lib/ext/img-conv/img-conv.coffee \
  $here/$script_path \
  $format \
  $encoding
